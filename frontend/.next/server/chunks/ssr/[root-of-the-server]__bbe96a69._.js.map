{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 100, "column": 0}, "map": {"version":3,"sources":["file:///Users/vishalprajwal/Documents/mental-health/frontend/src/lib/firebase.js"],"sourcesContent":["import { initializeApp, getApps } from \"firebase/app\";\nimport { getAuth } from \"firebase/auth\";\nimport { getFirestore } from \"firebase/firestore\";\n\nconst firebaseConfig = {\n  apiKey: \"AIzaSyAE-k8r8F4II_5rBfTvh6BNzQDku7KE_Gg\",\n  authDomain: \"mental-health-87a9d.firebaseapp.com\",\n  projectId: \"mental-health-87a9d\",\n  storageBucket: \"mental-health-87a9d.firebasestorage.app\",\n  messagingSenderId: \"500649525001\",\n  appId: \"1:500649525001:web:60ff34cd3656aebcbe9dd8\",\n  measurementId: \"G-6EVCYEMBVS\"\n};\n\nlet app;\nif (!getApps().length) {\n  app = initializeApp(firebaseConfig);\n} else {\n  app = getApps()[0];\n}\n\nconst auth = getAuth(app);\nconst db = getFirestore(app);\n\nexport { app, auth, db };"],"names":[],"mappings":";;;;;;;;AAAA;AAAA;AACA;AAAA;AACA;AAAA;;;;AAEA,MAAM,iBAAiB;IACrB,QAAQ;IACR,YAAY;IACZ,WAAW;IACX,eAAe;IACf,mBAAmB;IACnB,OAAO;IACP,eAAe;AACjB;AAEA,IAAI;AACJ,IAAI,CAAC,IAAA,2KAAO,IAAG,MAAM,EAAE;IACrB,MAAM,IAAA,iLAAa,EAAC;AACtB,OAAO;IACL,MAAM,IAAA,2KAAO,GAAE,CAAC,EAAE;AACpB;AAEA,MAAM,OAAO,IAAA,6KAAO,EAAC;AACrB,MAAM,KAAK,IAAA,iLAAY,EAAC","debugId":null}},
    {"offset": {"line": 157, "column": 0}, "map": {"version":3,"sources":["file:///Users/vishalprajwal/Documents/mental-health/frontend/src/app/admin/dashboard/page.jsx"],"sourcesContent":["\"use client\";\nimport { useEffect, useState } from \"react\";\nimport { auth } from '@/lib/firebase';\nimport { onAuthStateChanged } from 'firebase/auth';\nimport { useRouter } from 'next/navigation';\n\nexport default function AdminDashboard() {\n  const [user, setUser] = useState(null);\n  const router = useRouter();\n  const [usersData, setUsersData] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [search, setSearch] = useState(\"\");\n  const [filterLevel, setFilterLevel] = useState(\"all\");\n  const [currentPage, setCurrentPage] = useState(1);\n  const [selectedUser, setSelectedUser] = useState(null);\n  const [userHistory, setUserHistory] = useState([]);\n  const rowsPerPage = 10;\n\n  useEffect(() => {\n    const unsubscribe = onAuthStateChanged(auth, (currentUser) => {\n      if (currentUser) {\n        setUser(currentUser);\n      } else {\n        router.push('/login');\n      }\n    });\n    return () => unsubscribe();\n  }, [router]);\n\n  // Fetch all admin data from the correct backend endpoint\n  useEffect(() => {\n    const fetchAdminData = async () => {\n      setLoading(true);\n      try {\n        const apiUrl = process.env.NEXT_PUBLIC_BACKEND_API_URL || 'http://localhost:8000';\n        const res = await fetch(`${apiUrl}/api/admin-data`);\n        if (!res.ok) throw new Error('Failed to fetch admin data');\n        const data = await res.json();\n        setUsersData(data);\n      } catch (err) {\n        console.error(\"Error fetching admin data:\", err);\n      } finally {\n        setLoading(false);\n      }\n    };\n    if (user) {\n        fetchAdminData();\n    }\n  }, [user]);\n\n  const filteredData = usersData.filter((user) => {\n    const searchMatch = user.email && (\n      user.email.toLowerCase().includes(search.toLowerCase()) ||\n      user.uid.toLowerCase().includes(search.toLowerCase())\n    );\n    const levelMatch =\n      filterLevel === \"all\" ? true\n        : filterLevel === \"low\" ? user.stressLevel < 4\n        : filterLevel === \"medium\" ? user.stressLevel >= 4 && user.stressLevel <= 7\n        : filterLevel === \"high\" ? user.stressLevel > 7\n        : filterLevel === \"na\" ? user.stressLevel === \"N/A\"\n        : true;\n    return searchMatch && levelMatch;\n  });\n\n  const totalPages = Math.ceil(filteredData.length / rowsPerPage);\n  const paginatedData = filteredData.slice((currentPage - 1) * rowsPerPage, currentPage * rowsPerPage);\n\n  const getRowColor = (stressLevel) => {\n    if (stressLevel === \"N/A\") return \"bg-gray-200\";\n    if (stressLevel < 4) return \"bg-green-100\";\n    if (stressLevel <= 7) return \"bg-yellow-100\";\n    return \"bg-red-100\";\n  };\n\n  const lowCount = usersData.filter(u => u.stressLevel !== \"N/A\" && u.stressLevel < 4).length;\n  const mediumCount = usersData.filter(u => u.stressLevel >= 4 && u.stressLevel <= 7).length;\n  const highCount = usersData.filter(u => u.stressLevel > 7).length;\n  const naCount = usersData.filter(u => u.stressLevel === \"N/A\").length;\n\n  // Fetch a single user's history from the correct backend endpoint\n  const handleUserClick = async (user) => {\n    setSelectedUser(user);\n    try {\n      const apiUrl = process.env.NEXT_PUBLIC_BACKEND_API_URL || 'http://localhost:8000';\n      const res = await fetch(`${apiUrl}/api/user-history?uid=${user.uid}`);\n      const history = await res.json();\n      setUserHistory(history.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp)));\n    } catch (err) {\n      console.error(\"Error fetching user history:\", err);\n      setUserHistory([]);\n    }\n  };\n\n  const closeModal = () => {\n    setSelectedUser(null);\n    setUserHistory([]);\n  };\n\n  if(!user) return <p className=\"text-center mt-10\">Loading...</p>;\n\n  return (\n    <div className=\"min-h-screen p-8 bg-gray-100\">\n      <h1 className=\"text-3xl font-bold mb-4\">Admin Dashboard - Student Stress Levels</h1>\n      <div className=\"flex flex-wrap gap-4 mb-4\">\n        <div className=\"px-4 py-2 bg-green-200 rounded font-semibold\">Low Stress: {lowCount}</div>\n        <div className=\"px-4 py-2 bg-yellow-200 rounded font-semibold\">Medium Stress: {mediumCount}</div>\n        <div className=\"px-4 py-2 bg-red-200 rounded font-semibold\">High Stress: {highCount}</div>\n        <div className=\"px-4 py-2 bg-gray-200 rounded font-semibold\">N/A: {naCount}</div>\n      </div>\n      <div className=\"flex flex-wrap gap-4 mb-4\">\n        <input\n          type=\"text\"\n          placeholder=\"Search by email or UID\"\n          value={search}\n          onChange={(e) => setSearch(e.target.value)}\n          className=\"px-4 py-2 rounded border focus:outline-none focus:ring-2 focus:ring-blue-500\"\n        />\n        <select value={filterLevel} onChange={(e) => setFilterLevel(e.target.value)} className=\"px-4 py-2 rounded border focus:outline-none focus:ring-2 focus:ring-blue-500\">\n          <option value=\"all\">All Levels</option>\n          <option value=\"low\">Low (0-3)</option>\n          <option value=\"medium\">Medium (4-7)</option>\n          <option value=\"high\">High (8-10)</option>\n          <option value=\"na\">N/A</option>\n        </select>\n      </div>\n      {loading ? <p className=\"text-center text-gray-500\">Loading student data...</p> : (\n        <>\n          <div className=\"overflow-x-auto bg-white shadow-md rounded-lg\">\n            <table className=\"min-w-full\">\n              <thead className=\"bg-indigo-600 text-white\">\n                <tr>\n                  <th className=\"py-3 px-6 text-left\">Email</th>\n                  <th className=\"py-3 px-6 text-left\">UID</th>\n                  <th className=\"py-3 px-6 text-left\">Stress Level</th>\n                  <th className=\"py-3 px-6 text-left\">Last Updated</th>\n                </tr>\n              </thead>\n              <tbody>\n                {paginatedData.map((user) => (\n                  <tr key={user.uid} className={`border-b hover:bg-gray-50 cursor-pointer ${getRowColor(user.stressLevel)}`} onClick={() => handleUserClick(user)}>\n                    <td className=\"py-3 px-6\">{user.email}</td>\n                    <td className=\"py-3 px-6 truncate max-w-xs\">{user.uid}</td>\n                    <td className=\"py-3 px-6\">{user.stressLevel}{user.stressLevel !== \"N/A\" && \" / 10\"}</td>\n                    <td className=\"py-3 px-6\">{user.updatedAt ? new Date(user.updatedAt).toLocaleString() : \"-\"}</td>\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </div>\n          <div className=\"flex justify-center items-center gap-2 mt-4\">\n            <button onClick={() => setCurrentPage((p) => Math.max(p - 1, 1))} disabled={currentPage === 1} className=\"px-3 py-1 rounded border disabled:opacity-50\">Prev</button>\n            <span>Page {currentPage} of {totalPages || 1}</span>\n            <button onClick={() => setCurrentPage((p) => Math.min(p + 1, totalPages))} disabled={currentPage === totalPages || totalPages === 0} className=\"px-3 py-1 rounded border disabled:opacity-50\">Next</button>\n          </div>\n        </>\n      )}\n      {selectedUser && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\n          <div className=\"bg-white rounded-lg p-6 w-full max-w-lg shadow-xl relative\">\n            <h2 className=\"text-xl font-bold mb-4\">{selectedUser.email} - Stress History</h2>\n            <button onClick={closeModal} className=\"absolute top-3 right-3 text-gray-500 hover:text-gray-800 font-bold text-2xl\">&times;</button>\n            {userHistory.length === 0 ? <p>No stress entries yet.</p> : (\n              <ul className=\"space-y-2 max-h-80 overflow-y-auto\">\n                {userHistory.map((entry, idx) => (\n                  <li key={idx} className=\"border rounded p-3 flex justify-between bg-gray-50\">\n                    <span>Stress Level: {entry.stressLevel} / 10</span>\n                    <span className=\"text-gray-600\">{new Date(entry.timestamp).toLocaleString()}</span>\n                  </li>\n                ))}\n              </ul>\n            )}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n\n"],"names":[],"mappings":"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","debugId":null}}]
}