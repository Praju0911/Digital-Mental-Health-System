{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/vishalprajwal/Documents/mental-health/frontend/src/lib/firebase.js"],"sourcesContent":["import { initializeApp, getApps } from \"firebase/app\";\nimport { getAuth } from \"firebase/auth\";\nimport { getFirestore } from \"firebase/firestore\";\n\nconst firebaseConfig = {\n  apiKey: \"AIzaSyAE-k8r8F4II_5rBfTvh6BNzQDku7KE_Gg\",\n  authDomain: \"mental-health-87a9d.firebaseapp.com\",\n  projectId: \"mental-health-87a9d\",\n  storageBucket: \"mental-health-87a9d.firebasestorage.app\",\n  messagingSenderId: \"500649525001\",\n  appId: \"1:500649525001:web:60ff34cd3656aebcbe9dd8\",\n  measurementId: \"G-6EVCYEMBVS\"\n};\n\nlet app;\nif (!getApps().length) {\n  app = initializeApp(firebaseConfig);\n} else {\n  app = getApps()[0];\n}\n\nconst auth = getAuth(app);\nconst db = getFirestore(app);\n\nexport { app, auth, db };"],"names":[],"mappings":";;;;;;;;AAAA;AAAA;AACA;AAAA;AACA;AAAA;;;;AAEA,MAAM,iBAAiB;IACrB,QAAQ;IACR,YAAY;IACZ,WAAW;IACX,eAAe;IACf,mBAAmB;IACnB,OAAO;IACP,eAAe;AACjB;AAEA,IAAI;AACJ,IAAI,CAAC,IAAA,8KAAO,IAAG,MAAM,EAAE;IACrB,MAAM,IAAA,oLAAa,EAAC;AACtB,OAAO;IACL,MAAM,IAAA,8KAAO,GAAE,CAAC,EAAE;AACpB;AAEA,MAAM,OAAO,IAAA,wKAAO,EAAC;AACrB,MAAM,KAAK,IAAA,kLAAY,EAAC","debugId":null}},
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/vishalprajwal/Documents/mental-health/frontend/src/app/student/chat/%5BsessionId%5D/page.jsx"],"sourcesContent":["\"use client\";\nimport { useState, useEffect, useRef } from 'react';\nimport { auth, db } from '@/lib/firebase';\nimport { collection, addDoc, serverTimestamp, query, orderBy, onSnapshot, getDocs, where, deleteDoc, doc } from 'firebase/firestore';\nimport { onAuthStateChanged } from 'firebase/auth';\nimport { useParams, useRouter } from 'next/navigation';\n\nexport default function StudentChatRoom() {\n  const [user, setUser] = useState(null);\n  const [messages, setMessages] = useState([]);\n  const [newMessage, setNewMessage] = useState('');\n  const params = useParams();\n  const router = useRouter();\n  const sessionId = params.sessionId;\n  const messagesEndRef = useRef(null);\n\n  useEffect(() => {\n    const unsubscribe = onAuthStateChanged(auth, (currentUser) => {\n      if (currentUser) {\n        setUser(currentUser);\n      } else {\n        router.push('/login');\n      }\n    });\n    return () => unsubscribe();\n  }, [router]);\n\n  // Set up a real-time listener for messages in this chat session\n  useEffect(() => {\n    if (!sessionId) return;\n    const messagesRef = collection(db, 'chatSessions', sessionId, 'messages');\n    const q = query(messagesRef, orderBy('timestamp'));\n\n    const unsubscribe = onSnapshot(q, (querySnapshot) => {\n      const msgs = [];\n      querySnapshot.forEach((doc) => {\n        msgs.push({ id: doc.id, ...doc.data() });\n      });\n      setMessages(msgs);\n    });\n\n    return () => unsubscribe();\n  }, [sessionId]);\n\n  // Automatically scroll to the latest message\n  useEffect(() => {\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  }, [messages]);\n\n  const handleSendMessage = async (e) => {\n    e.preventDefault();\n    if (newMessage.trim() === '' || !user || !sessionId) return;\n\n    const messagesRef = collection(db, 'chatSessions', sessionId, 'messages');\n    await addDoc(messagesRef, {\n      text: newMessage,\n      senderId: user.uid,\n      timestamp: serverTimestamp()\n    });\n\n    setNewMessage('');\n  };\n\n  const handleEndChat = async () => {\n    if (!user || !sessionId) return;\n    // Simply navigate back to the dashboard. The session remains in Firestore for history.\n    router.push('/student/dashboard');\n  };\n\n  if (!user) {\n    return <p className=\"text-center mt-20\">Loading...</p>;\n  }\n\n  return (\n    <div className=\"flex flex-col h-screen bg-gray-100\">\n        <header className=\"bg-white p-4 shadow-md flex justify-between items-center\">\n            <h1 className=\"text-xl font-semibold\">Speaking with a Professional</h1>\n            <button \n              onClick={handleEndChat} \n              className=\"bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600\"\n            >\n                End Chat\n            </button>\n        </header>\n\n        <main className=\"flex-1 overflow-y-auto p-4\">\n            <div className=\"space-y-2\">\n                {messages.map(msg => (\n                    <div key={msg.id} className={`flex ${msg.senderId === user.uid ? 'justify-end' : 'justify-start'}`}>\n                        <div className={`p-3 rounded-xl max-w-xs lg:max-w-md ${msg.senderId === user.uid ? 'bg-blue-600 text-white rounded-br-none' : 'bg-gray-200 text-gray-800 rounded-bl-none'}`}>\n                            {msg.text}\n                        </div>\n                    </div>\n                ))}\n                <div ref={messagesEndRef} />\n            </div>\n        </main>\n\n        <footer className=\"bg-white p-4 border-t\">\n            <form onSubmit={handleSendMessage} className=\"flex\">\n                <input\n                    type=\"text\"\n                    value={newMessage}\n                    onChange={(e) => setNewMessage(e.target.value)}\n                    placeholder=\"Type your message...\"\n                    className=\"flex-1 p-2 border rounded-l-lg\"\n                />\n                <button type=\"submit\" className=\"px-4 py-2 bg-blue-500 text-white rounded-r-lg hover:bg-blue-600\">\n                    Send\n                </button>\n            </form>\n        </footer>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}